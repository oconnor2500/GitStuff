#loading data for table conversion
pet.shine.clean <- read_csv(file = '/Users/christopheroconnor/Desktop/git_folder/clean_pet_SHINE.csv')

#converting long table to wide format
pet.shine.clean.wide <- pet.shine.clean %>% 
  select(record_id,
         hc_household_id,
         sex,
         race,
         race_white,
         race_black,
         race_asian,
         race_biracial,
         Cleanliness_impression,
         Have_Pets,
         pet_caretaker_enroll,
         pet_caretaker_followup,
         Type_of_Pet,
         pet_age,
         Pet_skin_condition,
         Pet_Surgery,
         Pet_Hair,
         Pet_Appetite,
         Pet_Energy,
         Pet_In_or_Out,
         Pet_in_Daycare_at_Enroll,
         Pet_in_Daycare_followup,
         Pet_take_Antibiotics_6mo_enroll,
         SHINE_assignment,
         visit,
         Enroll_SSTI_last_12mo,
         Followup_SSTI_last_12mo,
         Participant_Staph_Axilla,
         Participant_Staph_Nares,
         Participant_Staph_InguinalFold,
         Participant_PetStaph_Axilla,
         Participant_PetStaph_Nares,
         Participant_PetStaph_InguinalFold,
         Pet_Staph_Dorsal_Fur,
         Pet_Staph_Mouth,
         Pet_PetStaph_Dorsal_Fur,
         Pet_PetStaph_Mouth,
         Sofa_PetStaph_growth,
         TV_Remote_MSSP,
         TV_Remote_PetStaph_growth,
         Main_telephone_PetStaph_growth,
         Computer_keyboard_PetStaph_growth,
         Tablet_PetStaph_growth,
         Door_handle_out_PetStaph_growth,
         Bathroom_light_PetStaph_growth,
         Bathroom_sink_PetStaph_growth,
         Toilet_flush_PetStaph_growth,
         Kitchen_light_PetStaph_growth,
         Kitchen_sink_PetStaph_growth,
         Refrigerator_PetStaph_growth,
         Microwave_door_PetStaph_growth,
         Oven_door_PetStaph_growth,
         Participant_Axilla_MRSA,
         Participant_Nares_MRSA,
         Participant_InguinalFold_MRSA,
         Participant_Axilla_MSSA,
         Participant_Nares_MSSA,
         Participant_InguinalFold_MSSA,
         Dorsal_Fur_MRSA,
         Dorsal_Fur_MSSA,
         Pet_Mouth_MRSA,
         Pet_Mouth_MSSA,
         Participant_Axilla_MSSP,
         Participant_Nares_MSSP,
         Participant_InguinalFold_MSSP,
         Dorsal_Fur_MSSP,
         Pet_Mouth_MSSP,
         TV_Remote_MRSA,
         Sofa_MRSA,
         Telephone_MRSA,
         Comp_Keyboard_MRSA,
         Tablet_MRSA,
         Door_Out_MRSA,
         Bathroom_light_MRSA,
         Bathroom_sink_MRSA,
         Toilet_MRSA,
         Kitchen_light_MRSA,
         Kitchen_sink_MRSA,
         Refrigerator_MRSA,
         Microwave_MRSA,
         Oven_MRSA,
         TV_Remote_MSSA,
         Sofa_MSSA,
         Telephone_MSSA,
         Comp_Keyboard_MSSA,
         Tablet_MSSA,
         Door_Out_MSSA,
         Bathroom_light_MSSA,
         Bathroom_sink_MSSA,
         Toilet_MSSA,
         Kitchen_light_MSSA,
         Kitchen_sink_MSSA,
         Refrigerator_MSSA,
         Microwave_MSSA,
         Oven_MSSA,
         TV_Remote_MSSP,
         Sofa_MSSP,
         Telephone_MSSP,
         Comp_Keyboard_MSSP,
         Tablet_MSSP,
         Door_Out_MSSP,
         Bathroom_light_MSSP,
         Bathroom_sink_MSSP,
         Toilet_MSSP,
         Kitchen_light_MSSP,
         Kitchen_sink_MSSP,
         Refrigerator_MSSP,
         Microwave_MSSP,
         Oven_MSSP,
         Participant_Axilla_MRSP,
         Participant_Nares_MRSP,
         Participant_InguinalFold_MRSP,
         Dorsal_Fur_MRSP,
         Pet_Mouth_MRSP,
         TV_Remote_MRSP,
         Sofa_MRSP,
         Telephone_MRSP,
         Comp_Keyboard_MRSP,
         Tablet_MRSP,
         Door_Out_MRSP,
         Bathroom_light_MRSP,
         Bathroom_sink_MRSP,
         Toilet_MRSP,
         Kitchen_light_MRSP,
         Kitchen_sink_MRSP,
         Refrigerator_MRSP,
         Microwave_MRSP,
         Oven_MRSP,
         Participant_Axilla_MSSS,
         Participant_Nares_MSSS,
         Participant_InguinalFold_MSSS,
         Dorsal_Fur_MSSS,
         Pet_Mouth_MSSS,
         TV_Remote_MSSS,
         Sofa_MSSS,
         Telephone_MSSS,
         Comp_Keyboard_MSSS,
         Tablet_MSSS,
         Door_Out_MSSS,
         Bathroom_light_MSSS,
         Bathroom_sink_MSSS,
         Toilet_MSSS,
         Kitchen_light_MSSS,
         Kitchen_sink_MSSS,
         Refrigerator_MSSS,
         Microwave_MSSS,
         Oven_MSSS,
         Participant_Axilla_MSSD,
         Participant_Nares_MSSD,
         Participant_InguinalFold_MSSD,
         Dorsal_Fur_MSSD,
         Pet_Mouth_MSSD,
         TV_Remote_MSSD,
         Sofa_MSSD,
         Telephone_MSSD,
         Comp_Keyboard_MSSD,
         Tablet_MSSD,
         Door_Out_MSSD,
         Bathroom_light_MSSD,
         Bathroom_sink_MSSD,
         Toilet_MSSD,
         Kitchen_light_MSSD,
         Kitchen_sink_MSSD,
         Refrigerator_MSSD,
         Microwave_MSSD,
         Oven_MSSD,
         NaresMRSA_NaresMSSP,
         NaresMRSA_AxillaMSSP,
         NaresMRSA_InguinalMSSP,
         AxillaMRSA_NaresMSSP,
         AxillaMRSA_AxillaMSSP,
         AxillaMRSA_InguinalMSSP,
         InguinalMRSA_NaresMSSP,
         InguinalMRSA_NaresMSSP,
         InguinalMRSA_InguinalMSSP,
         NaresMSSA_NaresMSSP,
         NaresMSSA_AxillaMSSP,
         NaresMSSA_InguinalMSSP,
         AxillaMSSA_NaresMSSP,
         AxillaMSSA_AxillaMSSP,
         AxillaMSSA_InguinalMSSP,
         InguinalMSSA_NaresMSSP,
         InguinalMSSA_AxillaMSSP,
         InguinalMSSA_InguinalMSSP) %>% 
  setDT(pet.shine.clean) %>% 
  dcast(record_id ~ visit, value.var = c('hc_household_id',
                                         'sex',
                                         'race',
                                         'race_white',
                                         'race_black',
                                         'race_asian',
                                         'race_biracial',
                                         'SHINE_assignment',
                                         'Cleanliness_impression',
                                         'Have_Pets',
                                         'Type_of_Pet',
                                         'pet_age',
                                         'Pet_Surgery',
                                         'Pet_skin_condition',
                                         'Pet_Hair',
                                         'Pet_In_or_Out',
                                         'Pet_Appetite',
                                         'Pet_Energy',
                                         'Pet_in_Daycare_at_Enroll',
                                         'Pet_in_Daycare_followup',
                                         'Pet_take_Antibiotics_6mo_enroll',
                                         'pet_caretaker_enroll',
                                         'pet_caretaker_followup',
                                         'Enroll_SSTI_last_12mo',
                                         'Followup_SSTI_last_12mo',
                                         'Participant_Staph_Axilla',
                                         'Participant_Staph_Nares',
                                         'Participant_Staph_InguinalFold',
                                         'Participant_PetStaph_Axilla',
                                         'Participant_PetStaph_Nares',
                                         'Participant_PetStaph_InguinalFold',
                                         'Pet_Staph_Dorsal_Fur',
                                         'Pet_Staph_Mouth',
                                         'Pet_PetStaph_Dorsal_Fur',
                                         'Pet_PetStaph_Mouth',
                                         'Sofa_PetStaph_growth',
                                         'TV_Remote_MSSP',
                                         'TV_Remote_PetStaph_growth',
                                         'Main_telephone_PetStaph_growth',
                                         'Computer_keyboard_PetStaph_growth',
                                         'Tablet_PetStaph_growth',
                                         'Door_handle_out_PetStaph_growth',
                                         'Bathroom_light_PetStaph_growth',
                                         'Bathroom_sink_PetStaph_growth',
                                         'Toilet_flush_PetStaph_growth',
                                         'Kitchen_light_PetStaph_growth',
                                         'Kitchen_sink_PetStaph_growth',
                                         'Refrigerator_PetStaph_growth',
                                         'Microwave_door_PetStaph_growth',
                                         'Participant_Axilla_MRSA',
                                         'Participant_Nares_MRSA',
                                         'Participant_InguinalFold_MRSA',
                                         'Participant_Axilla_MSSA',
                                         'Participant_Nares_MSSA',
                                         'Participant_InguinalFold_MSSA',
                                         'Dorsal_Fur_MRSA',
                                         'Dorsal_Fur_MSSA',
                                         'Pet_Mouth_MRSA',
                                         'Pet_Mouth_MSSA',
                                         'Participant_Axilla_MSSP',
                                         'Participant_Nares_MSSP',
                                         'Participant_InguinalFold_MSSP',
                                         'Dorsal_Fur_MSSP',
                                         'Pet_Mouth_MSSP',
                                         'Oven_door_PetStaph_growth',
                                         'TV_Remote_MRSA',
                                         'Sofa_MRSA',
                                         'Telephone_MRSA',
                                         'Comp_Keyboard_MRSA',
                                         'Tablet_MRSA',
                                         'Door_Out_MRSA',
                                         'Bathroom_light_MRSA',
                                         'Bathroom_sink_MRSA',
                                         'Toilet_MRSA',
                                         'Kitchen_light_MRSA',
                                         'Kitchen_sink_MRSA',
                                         'Refrigerator_MRSA',
                                         'Microwave_MRSA',
                                         'Oven_MRSA',
                                         'TV_Remote_MSSA',
                                         'Sofa_MSSA',
                                         'Telephone_MSSA',
                                         'Comp_Keyboard_MSSA',
                                         'Tablet_MSSA',
                                         'Door_Out_MSSA',
                                         'Bathroom_light_MSSA',
                                         'Bathroom_sink_MSSA',
                                         'Toilet_MSSA',
                                         'Kitchen_light_MSSA',
                                         'Kitchen_sink_MSSA',
                                         'Refrigerator_MSSA',
                                         'Microwave_MSSA',
                                         'Oven_MSSA',
                                         'TV_Remote_MSSP',
                                         'Sofa_MSSP',
                                         'Telephone_MSSP',
                                         'Comp_Keyboard_MSSP',
                                         'Tablet_MSSP',
                                         'Door_Out_MSSP',
                                         'Bathroom_light_MSSP',
                                         'Bathroom_sink_MSSP',
                                         'Toilet_MSSP',
                                         'Kitchen_light_MSSP',
                                         'Kitchen_sink_MSSP',
                                         'Refrigerator_MSSP',
                                         'Microwave_MSSP',
                                         'Oven_MSSP',
                                         'Participant_Axilla_MRSP',
                                         'Participant_Nares_MRSP',
                                         'Participant_InguinalFold_MRSP',
                                         'Dorsal_Fur_MRSP',
                                         'Pet_Mouth_MRSP',
                                         'TV_Remote_MRSP',
                                         'Sofa_MRSP',
                                         'Telephone_MRSP',
                                         'Comp_Keyboard_MRSP',
                                         'Tablet_MRSP',
                                         'Door_Out_MRSP',
                                         'Bathroom_light_MRSP',
                                         'Bathroom_sink_MRSP',
                                         'Toilet_MRSP',
                                         'Kitchen_light_MRSP',
                                         'Kitchen_sink_MRSP',
                                         'Refrigerator_MRSP',
                                         'Microwave_MRSP',
                                         'Oven_MRSP',
                                         'Participant_Axilla_MSSS',
                                         'Participant_Nares_MSSS',
                                         'Participant_InguinalFold_MSSS',
                                         'Dorsal_Fur_MSSS',
                                         'Pet_Mouth_MSSS',
                                         'TV_Remote_MSSS',
                                         'Sofa_MSSS',
                                         'Telephone_MSSS',
                                         'Comp_Keyboard_MSSS',
                                         'Tablet_MSSS',
                                         'Door_Out_MSSS',
                                         'Bathroom_light_MSSS',
                                         'Bathroom_sink_MSSS',
                                         'Toilet_MSSS',
                                         'Kitchen_light_MSSS',
                                         'Kitchen_sink_MSSS',
                                         'Refrigerator_MSSS',
                                         'Microwave_MSSS',
                                         'Oven_MSSS',
                                         'Participant_Axilla_MSSD',
                                         'Participant_Nares_MSSD',
                                         'Participant_InguinalFold_MSSD',
                                         'Dorsal_Fur_MSSD',
                                         'Pet_Mouth_MSSD',
                                         'TV_Remote_MSSD',
                                         'Sofa_MSSD',
                                         'Telephone_MSSD',
                                         'Comp_Keyboard_MSSD',
                                         'Tablet_MSSD',
                                         'Door_Out_MSSD',
                                         'Bathroom_light_MSSD',
                                         'Bathroom_sink_MSSD',
                                         'Toilet_MSSD',
                                         'Kitchen_light_MSSD',
                                         'Kitchen_sink_MSSD',
                                         'Refrigerator_MSSD',
                                         'Microwave_MSSD',
                                         'Oven_MSSD',
                                         'NaresMRSA_NaresMSSP',
                                         'NaresMRSA_AxillaMSSP',
                                         'NaresMRSA_InguinalMSSP',
                                         'AxillaMRSA_NaresMSSP',
                                         'AxillaMRSA_AxillaMSSP',
                                         'AxillaMRSA_InguinalMSSP',
                                         'InguinalMRSA_NaresMSSP',
                                         'InguinalMRSA_NaresMSSP',
                                         'InguinalMRSA_InguinalMSSP',
                                         'NaresMSSA_NaresMSSP',
                                         'NaresMSSA_AxillaMSSP',
                                         'NaresMSSA_InguinalMSSP',
                                         'AxillaMSSA_NaresMSSP',
                                         'AxillaMSSA_AxillaMSSP',
                                         'AxillaMSSA_InguinalMSSP',
                                         'InguinalMSSA_NaresMSSP',
                                         'InguinalMSSA_AxillaMSSP',
                                         'InguinalMSSA_InguinalMSSP')) 



#This code set up binary variables for logistic regression analysis 
wide.pet.clean <- pet.shine.clean.wide %>% 
  select(-hc_household_id_1month,
         -hc_household_id_3month,
         -hc_household_id_6month,
         -hc_household_id_9month,
         -Have_Pets_1month,
         -Have_Pets_3month,
         -Have_Pets_6month,
         -Have_Pets_9month,
         -Cleanliness_impression_1month,
         -Cleanliness_impression_3month,
         -Cleanliness_impression_6month,
         -Cleanliness_impression_9month,
         -Pet_Hair_1month,
         -Pet_Hair_3month,
         -Pet_Hair_6month,
         -Pet_Hair_9month,
         -pet_age_1month,
         -pet_age_3month,
         -pet_age_6month,
         -pet_age_9month,
         -Pet_Appetite_1month,
         -Pet_Appetite_3month,
         -Pet_Appetite_6month,
         -Pet_Appetite_9month,
         -Pet_Energy_1month,
         -Pet_Energy_3month,
         -Pet_Energy_6month,
         -Pet_Energy_9month,
         -Pet_take_Antibiotics_6mo_enroll_1month,
         -Pet_take_Antibiotics_6mo_enroll_3month,
         -Pet_take_Antibiotics_6mo_enroll_6month,
         -Pet_take_Antibiotics_6mo_enroll_9month,
         -Pet_in_Daycare_at_Enroll_1month,
         -Pet_in_Daycare_at_Enroll_3month,
         -Pet_in_Daycare_at_Enroll_6month,
         -Pet_in_Daycare_at_Enroll_9month,
         -Pet_in_Daycare_followup_enroll,
         -Pet_In_or_Out_1month,
         -Pet_In_or_Out_3month,
         -Pet_In_or_Out_6month,
         -Pet_In_or_Out_9month,
         -Enroll_SSTI_last_12mo_1month,
         -Enroll_SSTI_last_12mo_3month,
         -Enroll_SSTI_last_12mo_6month,
         -Enroll_SSTI_last_12mo_9month,
         -Followup_SSTI_last_12mo_enroll,
         -pet_caretaker_enroll_1month,
         -pet_caretaker_enroll_3month,
         -pet_caretaker_enroll_6month,
         -pet_caretaker_enroll_9month,
         -pet_caretaker_followup_enroll,
         -sex_1month,
         -sex_3month,
         -sex_6month,
         -sex_9month,
         -race_1month,
         -race_3month,
         -race_6month,
         -race_9month,
         -race_white_1month,
         -race_white_3month,
         -race_white_6month,
         -race_white_9month,
         -race_black_1month,
         -race_black_3month,
         -race_black_6month,
         -race_black_9month,
         -race_asian_1month,
         -race_asian_3month,
         -race_asian_6month,
         -race_asian_9month,
         -race_biracial_1month,
         -race_biracial_3month,
         -race_biracial_6month,
         -race_biracial_9month,
         -Type_of_Pet_1month, 
         -Type_of_Pet_3month, 
         -Type_of_Pet_6month,
         -Type_of_Pet_9month,
         -Have_Pets_1month,
         -Have_Pets_3month,
         -Have_Pets_6month,
         -Have_Pets_9month,
         -SHINE_assignment_1month,
         -SHINE_assignment_3month,
         -SHINE_assignment_6month,
         -SHINE_assignment_9month,) %>% 
  rename('household_id' = 'hc_household_id_enroll',
         'sex' = 'sex_enroll',
         'race' = 'race_enroll',
         'race_white' = 'race_white_enroll',
         'race_black' = 'race_black_enroll',
         'race_asian' = 'race_asian_enroll',
         'race_biracial' = 'race_biracial_enroll',
         'Type_of_Pet' = 'Type_of_Pet_enroll',
         'Have_Pets' = 'Have_Pets_enroll',
         'Pet_Age' = 'pet_age_enroll',
         'SHINE_assignment' = 'SHINE_assignment_enroll',
         'Enroll_SSTI_last_12mo' = 'Enroll_SSTI_last_12mo_enroll',
         'pet_caretaker_enroll' = 'pet_caretaker_enroll_enroll',
         'Pet_Hair' = 'Pet_Hair_enroll',
         'Pet_In_or_Out' = 'Pet_In_or_Out_enroll',
         'Pet_Apppetite' = 'Pet_Appetite_enroll',
         'Pet_Energy' = 'Pet_Energy_enroll',
         'Pet_Antibiotic_6mo' = 'Pet_take_Antibiotics_6mo_enroll_enroll') %>% 
  rowid_to_column('ID') %>% 
  mutate(ID = as.numeric(ID)) %>% #the following code allows us to identify if an individual was colonized by MRSA the whole study
  mutate(Full_Study_Nares_MRSA = ifelse(Participant_Nares_MRSA_enroll == 'Yes' | 
                                          Participant_Nares_MRSA_1month == 'Yes' | 
                                          Participant_Nares_MRSA_3month == 'Yes' | 
                                          Participant_Nares_MRSA_6month == 'Yes' | 
                                          Participant_Nares_MRSA_9month == 'Yes', 'Colonized', 'Not Colonized')) %>% 
  mutate(Full_Study_Axilla_MRSA = ifelse(Participant_Axilla_MRSA_enroll == 'Yes' | 
                                           Participant_Axilla_MRSA_1month == 'Yes' | 
                                           Participant_Axilla_MRSA_3month == 'Yes' | 
                                           Participant_Axilla_MRSA_6month == 'Yes' | 
                                           Participant_Axilla_MRSA_9month == 'Yes', 'Colonized', 'Not Colonized')) %>% 
  mutate(Full_Study_Nares_MRSA = ifelse(Participant_Nares_MRSA_enroll == 'Yes' | 
                                          Participant_Nares_MRSA_1month == 'Yes' | 
                                          Participant_Nares_MRSA_3month == 'Yes' | 
                                          Participant_Nares_MRSA_6month == 'Yes' | 
                                          Participant_Nares_MRSA_9month == 'Yes', 'Colonized', 'Not Colonized'))
